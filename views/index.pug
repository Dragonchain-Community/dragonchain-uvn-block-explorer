extends ../node_modules/pug-bootstrap/_bootstrap

block body
	script(type='text/javascript', src='https://www.gstatic.com/charts/loader.js')

	+navbar("Dragonchain UVN Block Explorer","dropdown_menu","inverse")
	div.container
		h2 Chain ID: #{chain_id}
		div.well
			div.row
				div.col-sm-4
					p
						b Node Level:
						br
						span #{chain_level}
				div.col-sm-4
					p
						b Dragonchain Version:
						br
						span #{chain_version}
				div.col-sm-4
					p
						b Block Height:
						br
						span #{block_height}

			div.row
				div.col-sm-4
					p
						b Blocks Last 24 Hours:
						br
						span #{blocks_last_24_hours}

				div.col-sm-4
					p
						b Last Block Time:
						br
						span #{last_block_time} UTC (#{last_block_time_since})
				div.col-sm-4
					p
						b TIME @ Last Block:
						br
						span #{last_block_drgn_time}

		div.row
			div.col-sm-6
				div#chart_day_div

			div.col-sm-6
				div#chart_week_div


		div.row
			div.col-sm-12
				b Last Block:
				pre !{JSON.stringify(last_block, null, 2)}


	script.
		var blocksByHour = !{JSON.stringify(blocks_by_hour)};
		var blocksByDay = !{JSON.stringify(blocks_by_day)};


		google.charts.load('current', {packages: ['corechart', 'bar']});
		google.charts.setOnLoadCallback(drawCharts);

		function drawCharts() {
			drawChartDay();
			drawChartWeek();
		}

		function drawChartDay() {

			// Create the data table.
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Hour');
			data.addColumn('number', 'Blocks');

			for (var i = blocksByHour.length - 1; i >= 0; i--)
			{
				var element = blocksByHour[i];
				data.addRow([element.hour, element.times.length]);
			}


			// Set chart options
			var options = {'title':'Blocks by Hour (24 Hours)', 'width':'100%', 'height':500};

			// Instantiate and draw our chart, passing in some options.
			var chart = new google.visualization.ColumnChart(document.getElementById('chart_day_div'));
			chart.draw(data, options);
		}

		function drawChartWeek() {

			// Create the data table.
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Day');
			data.addColumn('number', 'Blocks');

			for (var i = blocksByDay.length - 1; i >= 0; i--)
			{
				var element = blocksByDay[i];
				data.addRow([element.day, element.blocks]);
			}


			// Set chart options
			var options = {'title':'Blocks by Day (7 Days)', 'width':'100%', 'height':500};

			// Instantiate and draw our chart, passing in some options.
			var chart = new google.visualization.ColumnChart(document.getElementById('chart_week_div'));
			chart.draw(data, options);
		}

